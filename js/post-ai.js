{let e=!0;const t=document.querySelector(".post-ai");let a="",n="",i=600,r=0,o=0,c=[],l=0;const s=t=>{if(e)if(s.start||(s.start=t),l=t-s.start,l>=20){if(s.start=t,r<n-1){let e=a.charAt(r+1),t=/[,.，。!?！？]/.test(e)?150:20;explanation.firstElementChild&&explanation.removeChild(explanation.firstElementChild),explanation.innerHTML+=e;let i=document.createElement("div");i.className="ai-cursor",explanation.appendChild(i),r++,150===t&&(document.querySelector(".ai-explanation .ai-cursor").style.opacity="0"),r===n-1&&(m.disconnect(),explanation.removeChild(explanation.firstElementChild)),c[0]=setTimeout((()=>{requestAnimationFrame(s)}),t)}}else requestAnimationFrame(s)},m=new IntersectionObserver((t=>{let n=t[0].isIntersecting;e=n,e&&(i=0===r?200:20,c[1]=setTimeout((()=>{o&&(r=0,o=0),0===r&&(explanation.innerHTML=a.charAt(0)),requestAnimationFrame(s)}),i))}),{threshold:0});function clearSTO(){c.length&&c.forEach((e=>{e&&clearTimeout(e)}))}function startAI(e,i=!0){r=0,o=1,clearSTO(),l=0,explanation.innerHTML=i?"生成中. . .":"请等待. . .",a=e,n=a.length,m.disconnect(),m.observe(t)}function aiIntroduce(){startAI("我是文章辅助AI: QX-AI，点击下方的按钮，让我生成本文简介、推荐相关文章等。")}function aiAbstract(){startAI(abstract_value)}function aiRecommend(){r=0,o=1,clearSTO(),l=0,explanation.innerHTML="生成中. . .",a="",n="",m.disconnect(),c[2]=setTimeout((()=>{explanation.innerHTML=recommendList()}),600)}function aiGoHome(){startAI("正在前往博客主页...",!1),c[2]=setTimeout((()=>{pjax.loadUrl("/")}),1e3)}function recommendList(){let e="推荐文章：<br />",t=document.querySelectorAll(".card-recommend-post .aside-list .aside-list-item .thumbnail");return t||(e="很抱歉，无法找到类似的文章，你也可以看看本站最新发布的文章：<br />",t=document.querySelectorAll(".card-recent-post .aside-list .aside-list-item .thumbnail")),e+='<div class="ai-recommend">',t.forEach(((t,a)=>{e+=`<div class="ai-recommend-item"><span>推荐${a+1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${t.href}')" title="${t.title}" data-pjax-state="">${t.title}</a></div>`})),e+="</div>",e}document.querySelectorAll(".ai-btn-item").forEach(((e,t)=>{e.addEventListener("click",(()=>{switch(t){case 0:aiIntroduce();break;case 1:aiAbstract();break;case 2:aiRecommend();break;case 3:aiGoHome()}}))})),aiIntroduce()}